{%- capture bothHaveTwoAndThree -%}
{% assign levelTwoLen = linklists[block.settings.mm_linklist].links | size  %}
{% if levelTwoLen <= 4 %}
  	{{allHaveThreeStr}}
{% else %}
  {% assign havelevelThreeLen = 0  %}
  {% assign onlyTwo = "" | split: ", "  %}
  {% assign bothTwoAndThree = "" | split: ", "  %}
  {% assign index = 0  %}
  {% for link in linklists[block.settings.mm_linklist].links %}
    {% assign temp =  linklists[block.settings.mm_linklist].links | slice: index %}
    {%- if link.links != blank -%}
    {% assign bothTwoAndThree = bothTwoAndThree | concat: temp %}
    {% else %}
    {% assign onlyTwo = onlyTwo | concat: temp %}
    {%- endif -%}
    {% assign index = index | plus: 1 %}
  {% endfor %}
	{% assign onlyTwoLen = onlyTwo | size  %}
	{% assign bothTwoAndThreeLen = bothTwoAndThree | size  %}
{% comment %}<span>有3级个数：{{bothTwoAndThreeLen}}</span><span>   没有3级个数：{{onlyTwoLen}}</span>{% endcomment %}
  <ul class="{{caseStr}}">
  
   {% assign index = 1  %}
   {% assign tIndex = 1  %}
   {% assign firstColumn = "" | split: ", "  %}
   {% assign secondColumn = "" | split: ", "  %}
   {% assign thirdColumn = "" | split: ", "  %}
   {% assign fourthColumn = "" | split: ", "  %}
   {% for link in bothTwoAndThree %}
    {% assign temp =  bothTwoAndThree | slice: index %}
    {% assign mymodulo =  tIndex | modulo: 4 %}
	{%if mymodulo == 1 %}
    	{% assign firstColumn = firstColumn | concat: temp %}
   	{%elsif mymodulo == 2 %}
    	{% assign secondColumn = secondColumn | concat: temp %}
    {%elsif mymodulo == 3 %}
    	{% assign thirdColumn = thirdColumn | concat: temp %}
    {%else%}
    	{% assign fourthColumn = fourthColumn | concat: temp %}
    {%endif%}
    {% assign index = index | plus: 1 %}
    {% assign tIndex = tIndex | plus: 1 %}
  {% endfor %}
  {% assign allColumn = "" | split: ", "  %}  
  {% assign allColumn = allColumn | concat: firstColumn | concat: secondColumn | concat: thirdColumn | concat: fourthColumn %}  

<ul class="one-column">    
{% for link in firstColumn%}
<ul>
  <li class="lvl-1  {% if link.active or link.child_active %} active{% endif %}">
    {%- assign label1 = link.title |  split: '[label' | last | split: ']' | first | prepend: "nm_label" -%}
    <a href="{{ link.url }}" class="site-nav lvl-1">{{ link.title | split: '[label' | first }}{% if link.title contains '[label' %}<span class="lbl {{label1}}">{{ section.settings[label1] }}</span>{% endif %}</a>
    {%- if link.links != blank -%}
      <ul class="subLinks">
        {%- for childlink in link.links -%}
        <li class="lvl-2">
          {%- assign label2 = childlink.title |  split: '[label' | last  | split: ']' | first | prepend: "nm_label" -%}
          <a href="{{ childlink.url }}" class="site-nav lvl-2">{{ childlink.title | split: '[label' | first }}{% if childlink.title contains '[label' %}<span class="lbl {{label2}}">{{ section.settings[label2] }}</span>{% endif %}</a>
        </li>
        {%- endfor -%}
      </ul>
    {%- endif -%}
  </li>
</ul>
{% endfor %}
 </ul>  

  <ul class="one-column">    
{% for link in secondColumn%}
<ul>
  <li class="lvl-1  {% if link.active or link.child_active %} active{% endif %}">
    {%- assign label1 = link.title |  split: '[label' | last | split: ']' | first | prepend: "nm_label" -%}
    <a href="{{ link.url }}" class="site-nav lvl-1">{{ link.title | split: '[label' | first }}{% if link.title contains '[label' %}<span class="lbl {{label1}}">{{ section.settings[label1] }}</span>{% endif %}</a>
    {%- if link.links != blank -%}
      <ul class="subLinks">
        {%- for childlink in link.links -%}
        <li class="lvl-2">
          {%- assign label2 = childlink.title |  split: '[label' | last  | split: ']' | first | prepend: "nm_label" -%}
          <a href="{{ childlink.url }}" class="site-nav lvl-2">{{ childlink.title | split: '[label' | first }}{% if childlink.title contains '[label' %}<span class="lbl {{label2}}">{{ section.settings[label2] }}</span>{% endif %}</a>
        </li>
        {%- endfor -%}
      </ul>
    {%- endif -%}
  </li>
</ul>
{% endfor %}
 </ul>  
    
    <ul class="one-column">    
{% for link in thirdColumn%}
<ul>
  <li class="lvl-1  {% if link.active or link.child_active %} active{% endif %}">
    {%- assign label1 = link.title |  split: '[label' | last | split: ']' | first | prepend: "nm_label" -%}
    <a href="{{ link.url }}" class="site-nav lvl-1">{{ link.title | split: '[label' | first }}{% if link.title contains '[label' %}<span class="lbl {{label1}}">{{ section.settings[label1] }}</span>{% endif %}</a>
    {%- if link.links != blank -%}
      <ul class="subLinks">
        {%- for childlink in link.links -%}
        <li class="lvl-2">
          {%- assign label2 = childlink.title |  split: '[label' | last  | split: ']' | first | prepend: "nm_label" -%}
          <a href="{{ childlink.url }}" class="site-nav lvl-2">{{ childlink.title | split: '[label' | first }}{% if childlink.title contains '[label' %}<span class="lbl {{label2}}">{{ section.settings[label2] }}</span>{% endif %}</a>
        </li>
        {%- endfor -%}
      </ul>
    {%- endif -%}
  </li>
</ul>
{% endfor %}
 </ul>  
    
    <ul class="one-column">    
{% for link in fourthColumn%}
<ul>
  <li class="lvl-1  {% if link.active or link.child_active %} active{% endif %}">
    {%- assign label1 = link.title |  split: '[label' | last | split: ']' | first | prepend: "nm_label" -%}
    <a href="{{ link.url }}" class="site-nav lvl-1">{{ link.title | split: '[label' | first }}{% if link.title contains '[label' %}<span class="lbl {{label1}}">{{ section.settings[label1] }}</span>{% endif %}</a>
    {%- if link.links != blank -%}
      <ul class="subLinks">
        {%- for childlink in link.links -%}
        <li class="lvl-2">
          {%- assign label2 = childlink.title |  split: '[label' | last  | split: ']' | first | prepend: "nm_label" -%}
          <a href="{{ childlink.url }}" class="site-nav lvl-2">{{ childlink.title | split: '[label' | first }}{% if childlink.title contains '[label' %}<span class="lbl {{label2}}">{{ section.settings[label2] }}</span>{% endif %}</a>
        </li>
        {%- endfor -%}
      </ul>
    {%- endif -%}
  </li>
</ul>
{% endfor %}
 </ul>  
 
    
    
   <ul class="one-column">
  {% for link in onlyTwo %}
  <li class="lvl-1  {% if link.active or link.child_active %} active{% endif %}">
    {%- assign label1 = link.title |  split: '[label' | last | split: ']' | first | prepend: "nm_label" -%}
    <a href="{{ link.url }}" class="site-nav lvl-1">{{ link.title | split: '[label' | first }}{% if link.title contains '[label' %}<span class="lbl {{label1}}">{{ section.settings[label1] }}</span>{% endif %}</a>
  </li>
  {% endfor %}
   </ul> 
  </ul>

{% endif %}  
{%- endcapture -%}

{%- capture onlyHaveTwoStr -%}
<ul class="{{caseStr}}">
{% for link in linklists[block.settings.mm_linklist].links %}
<li class="lvl-1  {% if link.active or link.child_active %} active{% endif %}">
  {%- assign label1 = link.title |  split: '[label' | last | split: ']' | first | prepend: "nm_label" -%}
  <a href="{{ link.url }}" class="site-nav lvl-1">{{ link.title | split: '[label' | first }}{% if link.title contains '[label' %}<span class="lbl {{label1}}">{{ section.settings[label1] }}</span>{% endif %}</a>
</li>
{% endfor %}
</ul>
{%- endcapture -%}


{%- capture allHaveThreeStr -%}
<ul class="{{caseStr}}">
{% for link in linklists[block.settings.mm_linklist].links %}
<ul>
  <li class="lvl-1  {% if link.active or link.child_active %} active{% endif %}">
    {%- assign label1 = link.title |  split: '[label' | last | split: ']' | first | prepend: "nm_label" -%}
    <a href="{{ link.url }}" class="site-nav lvl-1">{{ link.title | split: '[label' | first }}{% if link.title contains '[label' %}<span class="lbl {{label1}}">{{ section.settings[label1] }}</span>{% endif %}</a>
    {%- if link.links != blank -%}
      <ul class="subLinks">
        {%- for childlink in link.links -%}
        <li class="lvl-2">
          {%- assign label2 = childlink.title |  split: '[label' | last  | split: ']' | first | prepend: "nm_label" -%}
          <a href="{{ childlink.url }}" class="site-nav lvl-2">{{ childlink.title | split: '[label' | first }}{% if childlink.title contains '[label' %}<span class="lbl {{label2}}">{{ section.settings[label2] }}</span>{% endif %}</a>
        </li>
        {%- endfor -%}
      </ul>
    {%- endif -%}
  </li>
</ul>
{% endfor %}
</ul>
{%- endcapture -%}


{% case caseStr %}
  {% when "onlyHaveTwo" %}
     {{onlyHaveTwoStr}}
  {% when "allHaveThree" %}
     {{allHaveThreeStr}}
  {% else %}
     {{bothHaveTwoAndThree}}
{% endcase %}


